"use strict";(self.webpackChunkvideoteca_frontend=self.webpackChunkvideoteca_frontend||[]).push([[846],{7411:function(e,t,o){var r=o(4165),n=o(5861),a=o(3263),s=o(9778),c="https://sccotview.com/api/",i=a.Z.create({baseURL:c,timeout:5e3,headers:{Authorization:localStorage.getItem("access_token")?"JWT "+localStorage.getItem("access_token"):null,"Content-Type":"multipart/form-data",accept:"application/json"}});i.interceptors.response.use((function(e){return e}),function(){var e=(0,n.Z)((0,r.Z)().mark((function e(t){var o,n,a,l;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.config,"undefined"!==typeof t.response){e.next=4;break}return console.warn("A server/network error occurred. Looks like CORS might be the problem. Sorry about this - we will get it fixed shortly."),e.abrupt("return",Promise.reject(t));case 4:if(401!==t.response.status||o.url!==c+"api/token/refresh/"){e.next=7;break}return window.location.href="/loginuser/",e.abrupt("return",Promise.reject(t));case 7:if("token_not_valid"!==t.response.data.code||401!==t.response.status||"Unauthorized"!==t.response.statusText){e.next=26;break}if(!(n=localStorage.getItem("refresh_token"))){e.next=24;break}if(a=JSON.parse(s.lW.from(n.split(".")[1],"base64").toString()),l=Math.ceil(Date.now()/1e3),console.log(a.exp),!(a.exp>l)){e.next=17;break}return e.abrupt("return",i.post("api/token/refresh/",{refresh:n}).then((function(e){return localStorage.setItem("access_token",e.data.access_token),localStorage.setItem("refresh_token",e.data.refresh_token),i.defaults.headers.Authorization="JWT "+e.data.access_token,o.headers.Authorization="JWT "+e.data.access_token,i(o)})).catch((function(e){console.log(e)})));case 17:console.log("Refresh token is expired",a.exp,l),window.localStorage.removeItem("access_token"),window.localStorage.removeItem("refresh_token"),window.localStorage.removeItem("user"),window.location.href="/loginuser/";case 22:e.next=26;break;case 24:console.log("Refresh token not available."),window.location.href="/loginuser/";case 26:return 401===t.response.status&&(window.location.href="/loginuser/"),e.abrupt("return",Promise.reject(t));case 28:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t.Z=i},1846:function(e,t,o){o.r(t),o.d(t,{default:function(){return c}});var r=o(2791),n=o(7411),a=o(7689),s=o(184);function c(){var e=(0,a.s0)();return(0,r.useEffect)((function(){n.Z.post("logout/",{refresh_token:localStorage.getItem("refresh_token")}),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user"),n.Z.defaults.headers.Authorization=null,e("/loginuser"),window.location.reload()})),(0,s.jsx)("div",{children:"Logout"})}}}]);
//# sourceMappingURL=846.14aefb6d.chunk.js.map