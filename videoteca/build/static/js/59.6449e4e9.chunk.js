"use strict";(self.webpackChunkvideoteca_frontend=self.webpackChunkvideoteca_frontend||[]).push([[59],{7411:function(e,t,n){var r=n(4165),a=n(5861),s=n(3263),i=n(9778),o="https://sccotview.com/api/",c=["free/","free"],u=(localStorage.getItem("access_token"),s.Z.create({baseURL:o,timeout:5e3,headers:{"Content-Type":"multipart/form-data",accept:"application/json"}}));u.interceptors.request.use((function(e){var t=localStorage.getItem("access_token"),n=c.some((function(t){return e.url.includes(t)}));return t&&!n?e.headers.Authorization="JWT "+t:delete e.headers.Authorization,e})),u.interceptors.response.use((function(e){return e}),function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,s,c,l;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.config,"undefined"!==typeof t.response){e.next=4;break}return console.warn("A server/network error occurred. Looks like CORS might be the problem."),e.abrupt("return",Promise.reject(t));case 4:if(401!==t.response.status||n.url!==o+"api/token/refresh/"){e.next=7;break}return window.location.href="/userlogin1/",e.abrupt("return",Promise.reject(t));case 7:if("token_not_valid"!==t.response.data.code||401!==t.response.status||"Unauthorized"!==t.response.statusText){e.next=37;break}if(!(a=localStorage.getItem("refresh_token"))){e.next=34;break}if(s=JSON.parse(i.lW.from(a.split(".")[1],"base64").toString()),c=Math.ceil(Date.now()/1e3),!(s.exp>c)){e.next=29;break}return e.prev=13,e.next=16,u.post("api/token/refresh/",{refresh:a});case 16:return l=e.sent,localStorage.setItem("access_token",l.data.access_token),localStorage.setItem("refresh_token",l.data.refresh_token),u.defaults.headers.Authorization="JWT "+l.data.access_token,n.headers.Authorization="JWT "+l.data.access_token,e.abrupt("return",u(n));case 24:e.prev=24,e.t0=e.catch(13),console.log(e.t0);case 27:e.next=32;break;case 29:console.log("Refresh token is expired",s.exp,c),localStorage.clear(),window.location.href="/userlogin2/";case 32:e.next=37;break;case 34:console.log("Refresh token not available."),localStorage.clear(),window.location.href="/userlogin3/";case 37:return 401===t.response.status&&localStorage.clear(),e.abrupt("return",Promise.reject(t));case 39:case"end":return e.stop()}}),e,null,[[13,24]])})));return function(t){return e.apply(this,arguments)}}()),t.Z=u},4059:function(e,t,n){n.r(t),n.d(t,{default:function(){return N}});var r=n(9439),a=n(2791),s=n(4165),i=n(5861),o=n(7689),c=(n(8040),n(1174),n(3712)),u=n(8596),l=n(3767),d=n(6151),p=n(2680),f=n(6542),h=n(4942),x=n(1413),m=n(5987),v=n(5342),g=n(3360),Z=n(4437),b=(n(9629),n(184)),j=["handleClose","show","serie_id","currentItem","setFormData","newData"],y=(0,u.Z)((function(e){return{containerModal:{border:"2px solid #ccc",borderRadius:50,boxShadow:"4px 4px 4px 0px #5a28e550"},containerForm:{height:"3rem",background:"#BFF",border:"2px solid #ccc",borderRadius:50,boxShadow:"4px 4px 4px 0px #5a28e550"},"@media (max-width: 720px)":{root:{display:"flex"}}}})),k=function(e){var t=e.handleClose,n=e.show,o=e.serie_id,c=(e.currentItem,e.setFormData),u=e.newData,l=(0,m.Z)(e,j),d=(0,a.useState)(null),p=(0,r.Z)(d,2),k=p[0],w=p[1],S=function(e){var t=e.target.name;c((0,x.Z)((0,x.Z)({},u),{},(0,h.Z)({},t,e.target.value)))},C=function(){var e=(0,i.Z)((0,s.Z)().mark((function e(t){var n,r,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=new FormData,console.log(k),e.prev=3,o){e.next=13;break}return n.append("serie",u.serie),n.append("description",u.description),n.append("quantity",u.quantity),k&&n.append("featured_image",k),e.next=11,f.Ed(n);case 11:e.next=19;break;case 13:return n.append("serie",u.serie),n.append("description",u.description),n.append("quantity",u.quantity),k&&n.append("featured_image",k),e.next=19,f.Zg(o,n);case 19:return e.next=21,f._G();case 21:return r=e.sent,e.next=24,r;case 24:a=e.sent,console.log(a),console.log(n),l.setSeries(a),e.next=33;break;case 30:e.prev=30,e.t0=e.catch(3),console.log(e.t0);case 33:case"end":return e.stop()}}),e,null,[[3,30]])})));return function(t){return e.apply(this,arguments)}}(),_=y();return(0,b.jsxs)(v.Z,{show:n,onHide:t,"aria-labelledby":"example-custom-modal-styling-title",contentClassName:_.cloud,centered:!0,children:[(0,b.jsx)(v.Z.Header,{closeButton:!0,children:(0,b.jsx)(v.Z.Title,{id:"tituloModal",children:(0,b.jsx)("h2",{children:o?"Editar Registro":"Crear Registro"})})}),(0,b.jsx)(v.Z.Body,{id:"bodyModal",children:(0,b.jsxs)(Z.Z,{onSubmit:C,children:[(0,b.jsxs)(Z.Z.Group,{className:"mb-2 ",controlId:"exampleForm.ControlInput1",children:[(0,b.jsx)(Z.Z.Control,{type:"text",name:"serie",placeholder:"Nombre de la serie",value:u.serie||"",onChange:S}),(0,b.jsx)("br",{}),(0,b.jsx)(Z.Z.Control,{as:"textarea",rows:3,name:"description",placeholder:"Descripci\xf3n de la serie",value:u.description||"",onChange:S}),(0,b.jsx)("br",{}),(0,b.jsx)(Z.Z.Control,{type:"number",name:"quantity",placeholder:"Cantidad de videos",value:u.quantity||null,onChange:S}),(0,b.jsx)("input",{type:"file",className:"form-control mt-3",name:"imgSerie",onChange:function(e){"imgSerie"===e.target.name&&w(e.target.files[0])}})]}),(0,b.jsxs)(v.Z.Footer,{children:[(0,b.jsx)(g.Z,{variant:"secondary",onClick:t,children:"Close"}),(0,b.jsx)(g.Z,{variant:"primary",type:"submit",onClick:t,children:o?"Guardar Cambios":"Crear"})]})]})})]})},w=n(2918),S=n(7087),C=(n(9713),function(e){var t=e.series,n=(0,o.s0)(),h=(0,w.d)(!1),x=(0,r.Z)(h,3),m=x[0],v=x[1],g=x[2],Z=(0,a.useState)(""),j=(0,r.Z)(Z,2),y=j[0],C=j[1],_=(0,a.useState)({}),N=(0,r.Z)(_,2),I=N[0],D=N[1],P=(0,a.useState)(t),A=(0,r.Z)(P,2),R=A[0],q=A[1],z=(0,a.useState)({serie:"",description:"",quantity:0}),T=(0,r.Z)(z,2),E=T[0],F=T[1],L=(0,a.useContext)(p.Z).user,B=(0,u.Z)((function(e){return{paper:{marginTop:e.spacing(0),marginBottom:e.spacing(10),display:"flex",flexDirection:"column",alignItems:"center"},title1:{textAlign:"center",color:"white"}}})),G=function(){var e=(0,i.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C(t.id),D(t),F({serie:t.serie,description:t.description,quantity:t.quantity}),v(!0);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=(0,i.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C(null),D({}),F({serie:"",description:"",quantity:0}),v(!0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=(0,i.Z)((0,s.Z)().mark((function e(){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f._G();case 3:return t=e.sent,e.next=6,t;case 6:n=e.sent,console.log(n),q(n),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();(0,a.useEffect)((function(){L&&L.is_superuser?(O(),C(null)):n("/loginuser")}),[]);var J=B();return L?(0,b.jsxs)(c.Z,{children:[(0,b.jsx)("div",{className:J.paper,children:(0,b.jsx)("h1",{className:"mt-4 text-center",children:"Series"})}),(0,b.jsx)(l.Z,{alignItems:"center",children:(0,b.jsx)(d.Z,{variant:"contained",color:"primary",type:"submit",onClick:function(){return M()},children:"Registrar Series"})}),(0,b.jsx)("br",{}),(0,b.jsx)("br",{})," ",(0,b.jsx)("br",{}),(0,b.jsx)("div",{children:(0,b.jsx)("section",{className:"content",children:(0,b.jsx)("div",{className:"table-responsive table-condensed table-sm tabla",children:(0,b.jsxs)("table",{className:"table table-hover",id:"dataTableData",name:"dataTableData",style:{fontSize:11,textAlign:"center"},children:[(0,b.jsx)("thead",{className:J.title1,children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{style:{display:"none"},children:"Id"}),(0,b.jsx)("th",{children:"Codigo"}),(0,b.jsx)("th",{children:"Serie"}),(0,b.jsx)("th",{children:"Descripci\xf3n"}),(0,b.jsx)("th",{children:"Cantidad de videos"}),(0,b.jsx)("th",{children:"Imagen"}),(0,b.jsx)("th",{})]})}),(0,b.jsx)("tbody",{style:{backgroundColor:"white"},children:0===R.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:11,children:"No hay datos"})}):R.map((function(e,t){return(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{style:{display:"none"},children:e.id}),(0,b.jsx)("td",{children:e.id}),(0,b.jsx)("td",{children:e.serie}),(0,b.jsx)("td",{children:e.description}),(0,b.jsx)("td",{children:e.quantity}),(0,b.jsx)("td",{children:(0,b.jsx)(S.LazyLoadImage,{effect:"blur",src:"https://sccotview.com"+e.featured_image,alt:"",className:"img-fluid img-thumbnail"})}),(0,b.jsx)("td",{children:(0,b.jsx)("button",{className:"btn btn-outline-primary p-1 btn-sm float-right",type:"submit",onClick:function(){return G(e)},children:"editar"})})]},t)}))})]})})})}),(0,b.jsx)(k,{handleClose:g,show:m,serie_id:y,currentItem:I,setSeries:q,setFormData:F,newData:E})]}):(0,b.jsx)("p",{style:{fontSize:"25px"},children:"Inicia sesi\xf3n para ver todos los videos!"})}),_=n(2516);var N=function(){var e=(0,_.Z)(C),t=(0,a.useContext)(p.Z).user,n=(0,a.useState)({loading:!0,series:null}),s=(0,r.Z)(n,2),i=s[0],o=s[1];return(0,a.useEffect)((function(){f._G().then((function(e){o({loading:!1,series:e})}))}),[o]),t?(0,b.jsx)(c.Z,{children:(0,b.jsx)("div",{className:"App",children:(0,b.jsx)(e,{isLoading:i.loading,series:i.series})})}):(0,b.jsx)("p",{style:{fontSize:"25px"},children:"Inicia sesi\xf3n para ver todos los videos!"})}},2516:function(e,t,n){var r=n(1413),a=n(5987),s=(n(2791),n(184)),i=["isLoading"];t.Z=function(e){return function(t){var n=t.isLoading,o=(0,a.Z)(t,i);return n?(0,s.jsxs)("div",{className:"mt-4",style:{fontSize:"25px",display:"flex",justifyContent:"center",textAlign:"center",flexDirection:"column",alignItems:"center"},children:[(0,s.jsx)("div",{className:"spinner-grow text-light",role:"status",children:(0,s.jsx)("span",{className:"sr-only"})}),"Espera por favor"]}):(0,s.jsx)(e,(0,r.Z)({},o))}}},2918:function(e,t,n){n.d(t,{d:function(){return s}});var r=n(9439),a=n(2791),s=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=(0,a.useState)(e),n=(0,r.Z)(t,2),s=n[0],i=n[1],o=function(){return i(!0)},c=function(){return i(!1)};return[s,o,c]}},6542:function(e,t,n){n.d(t,{Ed:function(){return c},Zg:function(){return l},_G:function(){return o},dS:function(){return u}});var r=n(4165),a=n(5861),s=n(7411),i="https://sccotview.com/api/series/",o=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.Z.get(i);case 2:if(200!==(t=e.sent).status){e.next=7;break}return e.next=6,t.data;case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.Z.post(i,t);case 2:if(200!==(n=e.sent).status){e.next=7;break}return e.next=6,n.data;case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.Z.get("".concat(i).concat(t));case 2:if(200!==(n=e.sent).status){e.next=7;break}return e.next=6,n.data;case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t,n){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.Z.patch(i+t+"/",n);case 2:if(200!==(a=e.sent).status){e.next=5;break}return e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},3767:function(e,t,n){var r=n(4942),a=n(3366),s=n(7462),i=n(2791),o=n(1184),c=n(5682),u=n(8519),l=n(2466),d=n(6934),p=n(1402),f=n(184),h=["component","direction","spacing","divider","children"];function x(e,t){var n=i.Children.toArray(e).filter(Boolean);return n.reduce((function(e,r,a){return e.push(r),a<n.length-1&&e.push(i.cloneElement(t,{key:"separator-".concat(a)})),e}),[])}var m=(0,d.ZP)("div",{name:"MuiStack",slot:"Root",overridesResolver:function(e,t){return[t.root]}})((function(e){var t=e.ownerState,n=e.theme,a=(0,s.Z)({display:"flex",flexDirection:"column"},(0,o.k9)({theme:n},(0,o.P$)({values:t.direction,breakpoints:n.breakpoints.values}),(function(e){return{flexDirection:e}})));if(t.spacing){var i=(0,c.hB)(n),u=Object.keys(n.breakpoints.values).reduce((function(e,n){return("object"===typeof t.spacing&&null!=t.spacing[n]||"object"===typeof t.direction&&null!=t.direction[n])&&(e[n]=!0),e}),{}),d=(0,o.P$)({values:t.direction,base:u}),p=(0,o.P$)({values:t.spacing,base:u});"object"===typeof d&&Object.keys(d).forEach((function(e,t,n){if(!d[e]){var r=t>0?d[n[t-1]]:"column";d[e]=r}}));a=(0,l.Z)(a,(0,o.k9)({theme:n},p,(function(e,n){return{"& > :not(style) + :not(style)":(0,r.Z)({margin:0},"margin".concat((a=n?d[n]:t.direction,{row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"}[a])),(0,c.NA)(i,e))};var a})))}return a=(0,o.dt)(n.breakpoints,a)})),v=i.forwardRef((function(e,t){var n=(0,p.Z)({props:e,name:"MuiStack"}),r=(0,u.Z)(n),i=r.component,o=void 0===i?"div":i,c=r.direction,l=void 0===c?"column":c,d=r.spacing,v=void 0===d?0:d,g=r.divider,Z=r.children,b=(0,a.Z)(r,h),j={direction:l,spacing:v};return(0,f.jsx)(m,(0,s.Z)({as:o,ownerState:j,ref:t},b,{children:g?x(Z,g):Z}))}));t.Z=v},8519:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(3433),a=n(7462),s=n(3366),i=n(2466),o=n(7416),c=["sx"];function u(e){var t,n=e.sx,u=function(e){var t,n,r={systemProps:{},otherProps:{}},a=null!=(t=null==e||null==(n=e.theme)?void 0:n.unstable_sxConfig)?t:o.Z;return Object.keys(e).forEach((function(t){a[t]?r.systemProps[t]=e[t]:r.otherProps[t]=e[t]})),r}((0,s.Z)(e,c)),l=u.systemProps,d=u.otherProps;return t=Array.isArray(n)?[l].concat((0,r.Z)(n)):"function"===typeof n?function(){var e=n.apply(void 0,arguments);return(0,i.P)(e)?(0,a.Z)({},l,e):l}:(0,a.Z)({},l,n),(0,a.Z)({},d,{sx:t})}},9713:function(){},8040:function(){},9629:function(){}}]);
//# sourceMappingURL=59.6449e4e9.chunk.js.map